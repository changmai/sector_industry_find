@echo off
chcp 65001 >nul
REM ================================================================================
REM   [시뮬레이션 14] 조건 H, I 2단계 자동 최적화 (Mode 4)
REM ================================================================================
REM
REM   전제 조건:
REM   --------------------------------------------------------------------------
REM   12번, 13번 BAT 실행 후 H, I 파라미터가 default.json에 반영되어야 함
REM   (신호가 발생하는 파라미터로 업데이트 필요)
REM
REM   목적:
REM   --------------------------------------------------------------------------
REM   [1단계] H, I 개별 파라미터 최적화
REM   [2단계] H, I + 유망 조건(A, D, GT_A, GT_B)과 조합 테스트
REM
REM   테스트 조건:
REM   --------------------------------------------------------------------------
REM   - H: 눌림목 패턴 (세력 진입 후 조정)
REM   - I: 급등주 조정 (모멘텀 조정)
REM   - A: 섹터+업종 연속 상승 (강세장 핵심)
REM   - D: 이평선 정배열 (추세 확인)
REM   - GT_A: MACD 골든크로스
REM   - GT_B: RSI 매수 신호
REM
REM   기간: 2024.05.29 ~ 2025.06.30 (약 13개월)
REM   TP/SL: 10% / -5%
REM
REM   옵션 설명:
REM   --------------------------------------------------------------------------
REM   --auto-optimize: 2단계 자동 최적화 활성화
REM   --update-defaults: 최적 파라미터를 default.json에 자동 저장
REM
REM   예상 결과:
REM   --------------------------------------------------------------------------
REM   - H AND A, H AND D, H AND GT_A 등 조합 성과 확인
REM   - I AND A, I AND D, I AND GT_B 등 조합 성과 확인
REM   - 시장 상황별 유효한 H, I 조합 발굴
REM ================================================================================

cd /d "%~dp0.."

python combination_tester.py ^
    --conditions H,I,A,D,GT_A,GT_B ^
    --auto-optimize ^
    --update-defaults ^
    --start-date 20240529 ^
    --end-date 20250630 ^
    --tp 10 ^
    --sl -5 ^
    --max-holding 14 ^
    --min-trades 5 ^
    --min-size 2 ^
    --max-size 3 ^
    --sort-by avg_return ^
    --top 50 ^
    --log

echo.
echo ================================================================================
echo   테스트 완료
echo ================================================================================
echo   결과:
echo   - H, I 포함 유망 조합 확인
echo   - 최적 파라미터가 default.json에 자동 저장됨
echo   - logs 폴더에서 상세 결과 확인
echo ================================================================================

pause
